<!DOCTYPE html>
<html>
  <head>
    <title>Whoops.</title>
    <meta name="description" content="Our first page" />
    <meta name="keywords" content="html tutorial template" />

    <style>
      #canvas {
        position: fixed;
        top: 0;
        left: 0;
        z-index: -1;
      }
    </style>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@100;200;300;400;500;600;800&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <canvas id="canvas"></canvas>

    <script>
      const { createApp } = Vue;
      let title = "HUB";
      let message = "https://hub.ternent.dev";

      createApp({
        setup() {
          return {
            handleClick() {},
          };
        },
      }).mount("#app");

      let canvas;
      let context;
      let secondsPassed;
      let oldTimeStamp;
      let fps;
      let lastDrew = 0;

      var myImage = new Image();
      myImage.src = "assets/character.png";

      const w = 87,
        h = 150;
      let spriteNum = 0;
      let posX = window.innerWidth / 4;
      let posY = window.innerHeight - 20;

      // setInterval(() => {
      //   // console.log(posX)
      //   posX = posX + 2;
      // }, 30);

      sprites = [
        (posX, posY) => [
          myImage,
          w * 0,
          h * 0,
          87,
          150,
          0 + posX,
          posY - 150,
          87,
          150,
        ],
        (posX, posY) => [
          myImage,
          w * 0,
          h * 2,
          87,
          150,
          0 + posX,
          posY - 150,
          87,
          150,
        ],
        (posX, posY) => [
          myImage,
          w * 1,
          h * 0,
          87,
          150,
          0 + posX,
          posY - 150,
          87,
          150,
        ],
        (posX, posY) => [
          myImage,
          w * 2,
          h * 0,
          87,
          150,
          0 + posX,
          posY - 150,
          87,
          150,
        ],
        (posX, posY) => [
          myImage,
          w * 3,
          h * 0,
          87,
          150,
          0 + posX,
          posY - 150,
          87,
          150,
        ],
        (posX, posY) => [
          myImage,
          w * 4,
          h * 0,
          87,
          150,
          0 + posX,
          posY - 150,
          87,
          150,
        ],
        // [myImage, w * 0, h * 1, 87, 150 + posX, window.innerHeight - 150, 0, 87, 150],
        (posX, posY) => [
          myImage,
          w * 1,
          h * 1,
          87,
          150,
          0 + posX,
          posY - 150,
          87,
          150,
        ],
        (posX, posY) => [
          myImage,
          w * 1,
          h * 2,
          87,
          150,
          0 + posX,
          posY - 150,
          87,
          150,
        ],
        (posX, posY) => [
          myImage,
          w * 2,
          h * 1,
          87,
          150,
          0 + posX,
          posY - 150,
          87,
          150,
        ],
        (posX, posY) => [
          myImage,
          w * 2,
          h * 2,
          87,
          150,
          0 + posX,
          posY - 150,
          87,
          150,
        ],
        (posX, posY) => [
          myImage,
          w * 3,
          h * 1,
          87,
          150,
          0 + posX,
          posY - 150,
          87,
          150,
        ],
      ];

      window.onload = init;

      function init() {
        canvas = document.getElementById("canvas");
        context = canvas.getContext("2d");

        context.canvas.width = window.innerWidth;
        context.canvas.height = window.innerHeight;

        // Start the first frame request
        window.requestAnimationFrame(gameLoop);
      }

      function gameLoop(timeStamp) {
        // Calculate the number of seconds passed since the last frame
        secondsPassed = (timeStamp - oldTimeStamp) / 1000;
        oldTimeStamp = timeStamp;

        // Calculate fps
        fps = Math.round(1 / secondsPassed);

        // Calculate fps
        fps = Math.round(1 / secondsPassed);

        draw();

        // Draw number to the screen
        context.font = "200 16px Work Sans";
        context.fillStyle = "white";
        context.fillText(`${fps} fps`, 32, 20);

        // Keep requesting new frames
        window.requestAnimationFrame(gameLoop);
      }

      function draw() {
        context.fillStyle = "black";
        context.fillRect(0, 0, window.innerWidth, window.innerHeight);

        // context.font = "200 42px Work Sans";
        // context.textAlign = "center";
        // context.fillStyle = "white";
        // context.strokeStyle = "white";
        // context.fillText("hub.", canvas.width / 2, canvas.height / 2);

        context.font = "200 18px Work Sans";
        context.textAlign = "center";
        context.fillStyle = Math.random() > 0.1 ? "#aaa" : "#888";
        context.fillText(message, canvas.width - 110, canvas.height - 15);

        if (myImage.complete) {
          context.drawImage(...sprites[spriteNum](posX, posY));
          if (Date.now() - lastDrew > 60) {
            if (spriteNum < sprites.length - 1) {
              spriteNum++;
            } else {
              spriteNum = 0;
            }
            lastDrew = Date.now();
          }
        }

        // console.log(lastDrew)
      }
    </script>
  </body>
</html>
